Sub FiltrirajRedoveIBrisiPrazneSheetoveCijeliWorkbook()
    Dim lastRow As Long
    Dim i As Long
    Dim trazenaVrijednostC As String
    Dim trazenaVrijednostD As String
    Dim ws As Worksheet
    Dim wb As Workbook
    Dim wsToDelete As Collection
    Dim deleteSheet As Boolean
    
    ' Radimo sa svim sheetovima u trenutnom workbooku
    Set wb = ThisWorkbook
    Set wsToDelete = New Collection ' Lista za sheetove koje treba obrisati

    ' Uklanjanje svih filtera u svim sheetovima
    For Each ws In wb.Sheets
        If ws.AutoFilterMode Then
            ws.AutoFilterMode = False
        End If
    Next ws

    ' Korisnik unosi vrijednost koja se tra?i u kolumni C
    trazenaVrijednostC = InputBox("Unesite sadr?aj koji ?elite pretra?iti u kolumni C:", "Pretraga C kolumne")
    
    ' Korisnik unosi vrijednost koja mora biti u istoj row-u u kolumni D
    trazenaVrijednostD = InputBox("Unesite sadr?aj koji mora biti u istoj kolumni D:", "Pretraga D kolumne")
    
    ' Provjera je li unesena vrijednost prazna
    If Len(Trim(trazenaVrijednostC)) = 0 Or Len(Trim(trazenaVrijednostD)) = 0 Then
        MsgBox "Morate unijeti obje vrijednosti za pretragu!", vbExclamation
        Exit Sub
    End If
    
    ' Druga petlja kroz sve worksheet-ove u workbooku za filtriranje
    For Each ws In wb.Sheets
        deleteSheet = True ' Pretpostavljamo da ?e se sheet obrisati osim ako se ne prona?e odgovaraju?i redak
        
        ' Prona?i zadnji redak s podacima u kolumni C za trenutni sheet
        lastRow = ws.Cells(ws.Rows.Count, "C").End(xlUp).Row
        
        ' Petlja ide od zadnjeg do drugog retka za filtriranje
        For i = lastRow To 2 Step -1
            ' Provjeravamo odgovara li vrijednost u C i D tra?enim vrijednostima
            If Trim(ws.Cells(i, 3).Value) = Trim(trazenaVrijednostC) And Trim(ws.Cells(i, 4).Value) = Trim(trazenaVrijednostD) Then
                deleteSheet = False ' Ako prona?emo odgovaraju?i redak, sheet se ne bri?e
            Else
                ' Ako ne odgovara, bri?emo cijeli redak
                ws.Rows(i).Delete
            End If
        Next i
        
        ' Ako nema odgovaraju?ih redova, dodajemo sheet na listu za brisanje
        If deleteSheet Then
            wsToDelete.Add ws.Name
        End If
    Next ws
    
    ' Brisanje sheetova koji nemaju odgovaraju?e podatke
    Application.DisplayAlerts = False ' Isklju?ujemo upozorenje za brisanje sheetova
    For i = 1 To wsToDelete.Count
        wb.Sheets(wsToDelete(i)).Delete
    Next i
    Application.DisplayAlerts = True ' Ponovno uklju?ujemo upozorenja
    
    MsgBox "Pretraga zavr?ena. Odgovaraju?i redovi su filtrirani, a sheetovi bez rezultata su obrisani."
End Sub

