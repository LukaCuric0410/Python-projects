Sub PremjestiSheetovePremaUnosuIRucnomFilePathu()
    Dim wb As Workbook
    Dim noviWb As Workbook
    Dim ws As Worksheet
    Dim sheetCount As Integer
    Dim trazenaVrijednost As String
    Dim i As Integer
    Dim filePath As String
    Dim b1Value As String
    
    ' Korisnik unosi tra?enu vrijednost putem InputBox-a
    trazenaVrijednost = InputBox("Unesite sadr?aj koji ?elite pretra?iti u ?eliji B1:", "Pretraga B1")
    
    ' Provjera je li unesena vrijednost prazna
    If Len(Trim(trazenaVrijednost)) = 0 Then
        MsgBox "Morate unijeti vrijednost za pretragu!", vbExclamation
        Exit Sub
    End If
    
    ' Ru?no definiramo putanju gdje ?e se spremiti novi workbook
    ' OVDJE UNOSI? PUTANJU ZA SPREMANJE WORKBOOK-A:
    filePath = "/Users/CuricL/Desktop/Posusje.xlsx"  ' Promijeni ovu putanju prema svojim potrebama
    
    ' Kreiramo novi workbook u koji ?emo premjestiti odgovaraju?e sheetove
    Set noviWb = Workbooks.Add
    
    ' Zapo?injemo s brojanjem sheetova koji odgovaraju
    sheetCount = 0
    
    ' Prolazimo kroz sve sheetove u trenutnom workbooku
    For i = ThisWorkbook.Sheets.Count To 1 Step -1
        Set ws = ThisWorkbook.Sheets(i)
        
        ' Preuzimamo i trimamo vrijednost iz B1 ?elije
        b1Value = Trim(ws.Range("B1").Value)
        
        ' Provjeravamo ako je vrijednost u B1 jednaka tra?enoj vrijednosti (tako?er Trim za uklanjanje vi?ka praznih znakova)
        If b1Value = Trim(trazenaVrijednost) Then
            ' Kopiramo sheet u novi workbook
            ws.Copy After:=noviWb.Sheets(noviWb.Sheets.Count)
            ' Pove?avamo broj sheetova koji su premje?teni
            sheetCount = sheetCount + 1
            
            ' Provjera da li sheet stvarno ?elimo obrisati
            If MsgBox("?elite li izbrisati sheet '" & ws.Name & "' nakon premje?tanja?", vbYesNo + vbQuestion) = vbYes Then
                ' Bri?emo sheet iz trenutnog workbooka
                Application.DisplayAlerts = False
                ws.Delete
                Application.DisplayAlerts = True
            End If
        End If
    Next i
    
    ' Ako su sheetovi uspje?no premje?teni
    If sheetCount > 0 Then
        ' Spremamo workbook na definiranu putanju
        noviWb.SaveAs filePath
        MsgBox "Svi odgovaraju?i sheetovi su premje?teni u novi workbook i spremljeni pod nazivom: " & filePath
    Else
        MsgBox "Nema sheetova sa sadr?ajem u ?eliji B1 koji odgovara unesenoj vrijednosti."
        ' Ako nema premje?tenih sheetova, zatvaramo prazan workbook bez spremanja
        noviWb.Close SaveChanges:=False
    End If
End Sub


