Sub FindAndDeleteAllSheetsMultipleSearchValues()
    Dim searchValues As String
    Dim foundCell As Range
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim searchArray() As String
    Dim searchValue As String
    Dim rowToKeep As Collection
    Dim j As Long

    ' Zatra?i od korisnika da unese sadr?aj koji se tra?i (odvojeno zarezima)
    searchValues = InputBox("Unesi vrijednosti koje zeli? traziti (odvoji zarezima):")

    ' Provjeri je li korisnik unio neki sadr?aj
    If searchValues = "" Then
        MsgBox "Unos nije vazeci. Poku?ajte ponovno."
        Exit Sub
    End If

    ' Razdvoji unesene vrijednosti na polje
    searchArray = Split(searchValues, ",")

    ' Prolazi kroz svaki radni list u radnoj knjizi
    For Each ws In ThisWorkbook.Sheets
        lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        Set rowToKeep = New Collection ' Kreiraj novu kolekciju za redke koje ?emo zadr?ati
        
        ' Petlja kroz svaku vrijednost iz polja
        For j = LBound(searchArray) To UBound(searchArray)
            searchValue = Trim(searchArray(j)) ' Uklanja nepotrebne razmake

            ' Prona?i ?eliju s tra?enim sadr?ajem na trenutnom radnom listu
            Set foundCell = ws.Cells.Find(What:=searchValue, LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)
            
            ' Ako je sadr?aj prona?en na ovom radnom listu
            If Not foundCell Is Nothing Then
                ' Dodaj sve redke koji sadr?e prona?eni tekst u kolekciju
                For i = 2 To lastRow ' Po?injemo od 2 da izbjegnemo prvi red
                    If InStr(1, ws.Cells(i, foundCell.Column).Value, searchValue, vbTextCompare) > 0 Then
                        On Error Resume Next ' Izbjegavanje gre?ke ako je redak ve? u kolekciji
                        rowToKeep.Add i, CStr(i) ' Dodaj redak u kolekciju koriste?i redni broj kao klju?
                        On Error GoTo 0 ' Vra?a standardno pona?anje gre?aka
                    End If
                Next i
            End If
        Next j

        ' Bri?i sve redove osim onih koje smo zadr?ali, ali zadr?i prvi red
        For i = lastRow To 2 Step -1 ' Po?injemo od kraja prema po?etku, izbjegavaju?i prvi red
            On Error Resume Next ' Izbjegavanje gre?ke ako redak nije u kolekciji
            rowToKeep.Item CStr(i) ' Provjerava da li redak postoji u kolekciji
            If Err.Number <> 0 Then
                ws.Rows(i).Delete ' Ako nije, brisi redak
                Err.Clear ' Resetuj gresku
            End If
            On Error GoTo 0 ' Vra?a standardno pona?anje gre?aka
        Next i
    Next ws
    
    ' Obavijesti korisnika da je operacija zavr?ena
    MsgBox "Zapamti, sve ti je ovo omogucio Luka!"
End Sub
